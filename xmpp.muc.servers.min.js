var Xmpp;(function(n){var t=function(){function t(n){this.conn=n,this.servers=[]}return t.prototype.refresh=function(n){if(n)this.getServer(n).getInfo();else for(var t in this.servers)this.servers[t].getInfo()},t.prototype.addServerAndGetInfo=function(n){this.addServer(n).getInfo()},t.prototype.addServer=function(t){var i=Strophe.getDomainFromJid(t);return this.servers[i]=new n.Server(i,this.conn),this.servers[i]},t.prototype.removeServer=function(n){var t=Strophe.getDomainFromJid(n);delete this.servers[t]},t.prototype.incomingMucMessage=function(n){var i,t,r,u=$(n),f=u.attr("type");return f==="groupchat"&&(i=u.attr("from"),r=Strophe.getDomainFromJid(i),t=this.servers[r],t)?t.incomingMucMessage(n):!1},t.prototype.isRoom=function(n){var t=this.getServer(n);return t?t.isRoom(n):!1},t.prototype.getServer=function(n){var t=Strophe.getDomainFromJid(n);return this.servers[t]},t.prototype.getMyServer=function(){return this.servers[Object.keys(this.servers)[0]]},t.prototype.getRoom=function(n){var t=null,i=this.getServer(n);return i&&(t=i.getRoom(n)),t},t.prototype.destroyRoom=function(n,t,i,r){var f=null,u=this.getServer(n);u&&u.destroyRoom(n,t,i,r)},t.prototype.updatePresence=function(n){var i=$(n).attr("from"),u=$(n).attr("type"),t=this.getRoom(i),r;return t&&(u==="unavailable"?t.removeOccupant(i):r=t.updateOccupant(n)),r},t.prototype.getOrAddRoom=function(t){var r,u=Strophe.getBareJidFromJid(t),i=this.getRoom(u);return i||(r=this.getServer(u),r||(r=this.addServer(u)),i=new n.Room(u,null,this.conn),i.getInfo(),r.rooms[i.jid]=i),i},t}();n.Servers=t})(Xmpp||(Xmpp={}))