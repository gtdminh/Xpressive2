var Xmpp;(function(n){var t=function(){function n(){}return n.prototype.init=function(n){this._connection=n,Strophe.addNamespace("CHATSTATES","http://jabber.org/protocol/chatstates")},n.prototype.statusChanged=function(n){(n===Strophe.Status.CONNECTED||n===Strophe.Status.ATTACHED)&&(this._connection.addHandler(this._notificationReceived.bind(this),Strophe.NS.CHATSTATES,"message"),this._connection.disco.addFeature(Strophe.NS.CHATSTATES))},n.prototype.addActive=function(n){return n.c("active",{xmlns:Strophe.NS.CHATSTATES}).up()},n.prototype._notificationReceived=function(n){var i=$(n).find("composing"),r=$(n).find("paused"),u=$(n).find("active"),f=$(n).find("gone"),t=$(n).attr("from");return i.length>0&&$(document).trigger("composing.chatstates",t),r.length>0&&$(document).trigger("paused.chatstates",t),u.length>0&&$(document).trigger("active.chatstates",t),f.length>0&&$(document).trigger("gone.chatstates",t),!0},n.prototype.sendActive=function(n,t){this._sendNotification(n,t,"active")},n.prototype.sendComposing=function(n,t){this._sendNotification(n,t,"composing")},n.prototype.sendPaused=function(n,t){this._sendNotification(n,t,"paused")},n.prototype.sendGone=function(n,t){this._sendNotification(n,t,"gone")},n.prototype._sendNotification=function(n,t,i){t||(t="chat"),this._connection.send($msg({to:n,type:t}).c(i,{xmlns:Strophe.NS.CHATSTATES}))},n}();n.Chatstates=t})(Xmpp||(Xmpp={})),Strophe.addConnectionPlugin("chatstates",function(){var n=new Xmpp.Chatstates;return{init:function(t){return n.init(t)},statusChanged:function(t){return n.statusChanged(t)},addActive:function(t){return n.addActive(t)},sendActive:function(t,i){return n.sendActive(t,i)},sendComposing:function(t,i){return n.sendComposing(t,i)},sendPaused:function(t,i){return n.sendPaused(t,i)},sendGone:function(t,i){return n.sendGone(t,i)}}}())